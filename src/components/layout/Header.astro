---
// Header component for the WHOIS Maroc landing page

// Get current pathname
const currentPath = Astro.url.pathname;

// Navigation items
const navItems = [
	{ href: '/', label: 'Accueil' },
	{ href: '/nom-de-domaine-maroc', label: 'Acheter un .MA' },
	{ href: '/a-propos', label: 'À propos' },
	{ href: '/termes-reserves', label: 'Termes réservés' },
	{ href: '/WHMCS', label: 'WHMCS' },
	{ href: '/', label: 'Whois Maroc' }
];

// Helper function to check if a link is active
function isActive(href: string, index: number): boolean {
	// Special case for home page - only active if exactly "/" and it's the first item
	if (href === '/') {
		// Only the first "/" link (Accueil) should be active on home page
		if (index === 0) {
			return currentPath === '/' || currentPath === '';
		}
		// The last "/" link (Whois Maroc) should not be active on home page
		return false;
	}
	// For other pages, check if current path starts with the href
	return currentPath.startsWith(href);
}

// Helper function to get link classes
function getLinkClasses(href: string, index: number): string {
	const baseClasses = 'hover:text-white transition-colors';
	const activeClasses = 'text-(--color-primary)';
	const inactiveClasses = 'text-white/80';
	
	return isActive(href, index) 
		? `${baseClasses} ${activeClasses}` 
		: `${baseClasses} ${inactiveClasses}`;
}
---

<header class="sticky top-0 z-50 bg-(--color-secondary) px-6 py-6 md:px-16 lg:px-24">
	<div class="max-w-7xl mx-auto flex items-center justify-between">
		<!-- Logo -->
		<div class="flex items-center gap-2">
			<a href="/" aria-label="WHOIS Maroc Home">
				<img src="/whois-logo.png" alt="WHOIS Maroc Logo" class="h-10 md:h-12" />
			</a>
		</div>
		
		<!-- Navigation -->
		<nav class="flex items-center gap-6">
			<!-- Mobile Menu Button (only visible on mobile) -->
			<button 
				id="mobile-menu-button"
				class="md:hidden text-white/90 hover:text-white flex items-center gap-2" 
				aria-label="Toggle menu"
				aria-expanded="false"
			>
				<span class="text-sm">Menu</span>
				<svg id="menu-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<line x1="3" y1="12" x2="21" y2="12"></line>
					<line x1="3" y1="6" x2="21" y2="6"></line>
					<line x1="3" y1="18" x2="21" y2="18"></line>
				</svg>
				<svg id="close-icon" class="hidden" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<line x1="18" y1="6" x2="6" y2="18"></line>
					<line x1="6" y1="6" x2="18" y2="18"></line>
				</svg>
			</button>
			
			<!-- Desktop Navigation (hidden on mobile) -->
			<div class="hidden md:flex items-center gap-4 text-sm">
				{navItems.map((item, index) => (
					<>
						<a href={item.href} class={getLinkClasses(item.href, index)}>
							{item.label}
						</a>
						{index < navItems.length - 1 && <span class="text-white/80">/</span>}
					</>
				))}
			</div>
		</nav>
	</div>
	
	<!-- Mobile Menu (hidden by default) -->
	<div id="mobile-menu" class="hidden md:hidden bg-(--color-secondary) border-t border-white/10">
		<div class="max-w-7xl mx-auto px-6 py-4">
			<nav class="flex flex-col gap-4">
				{navItems.map((item, index) => (
					<a href={item.href} class={`${getLinkClasses(item.href, index)} text-sm py-2`}>
						{item.label}
					</a>
				))}
			</nav>
		</div>
	</div>
</header>

<script>
	document.addEventListener('DOMContentLoaded', () => {
		const menuButton = document.getElementById('mobile-menu-button');
		const mobileMenu = document.getElementById('mobile-menu');
		const menuIcon = document.getElementById('menu-icon');
		const closeIcon = document.getElementById('close-icon');
		
		if (!menuButton || !mobileMenu || !menuIcon || !closeIcon) return;
		
		menuButton.addEventListener('click', () => {
			const isOpen = !mobileMenu.classList.contains('hidden');
			
			if (isOpen) {
				// Close menu
				mobileMenu.classList.add('hidden');
				menuIcon.classList.remove('hidden');
				closeIcon.classList.add('hidden');
				menuButton.setAttribute('aria-expanded', 'false');
			} else {
				// Open menu
				mobileMenu.classList.remove('hidden');
				menuIcon.classList.add('hidden');
				closeIcon.classList.remove('hidden');
				menuButton.setAttribute('aria-expanded', 'true');
			}
		});
		
		// Close menu when clicking on a link
		const menuLinks = mobileMenu.querySelectorAll('a');
		menuLinks.forEach(link => {
			link.addEventListener('click', () => {
				mobileMenu.classList.add('hidden');
				menuIcon.classList.remove('hidden');
				closeIcon.classList.add('hidden');
				menuButton.setAttribute('aria-expanded', 'false');
			});
		});
	});
</script>

