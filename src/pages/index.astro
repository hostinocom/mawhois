---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Hero from '../components/Hero.astro';
import Description from '../components/Description.astro';
import SearchResults from '../components/SearchResults.astro';
import { registries, defaultRegistry } from '../config/registries';

// Parse domain from URL query
function parseDomainFromUrl(fullDomain: string) {
	if (!fullDomain) return null;
	
	const trimmed = fullDomain.trim().toLowerCase();

	return trimmed;
}

// Check if there's a domain search query
const domainParam = Astro.url.searchParams.get('domain');
console.log('domainParam', domainParam);
const domain = domainParam ? parseDomainFromUrl(domainParam) : null;
console.log('domain', domain);
---

<Layout>
	<Header />
	
	{domain ? (
		<SearchResults domain={domain} extension=".ma" />
	) : (
		<>
		   <Hero registries={registries} defaultRegistry={defaultRegistry} />
			<Description />
		</>
	)}
</Layout>
